<script>
function openForm(){
	 document.getElementById("outerdiv").style.visibility= "visible";
	 document.getElementById("outerdiv").style.display= "block";
}
function hideform(){
	 document.getElementById("outerdiv").style.visibility= "hidden";
	 document.getElementById("outerdiv").style.display= "none";
}
function validateNewForm()
{
var title=document.forms["newStoryForm"]["title"].value;
var content=document.forms["newStoryForm"]["content"].value;


if (title==null || title=="" ||!title.match (/\S/))
  {
  alert("Please Fill Title Field");
  document.newStoryForm.title.focus() ;
  return false;
  }

if (content==null || content==""||!content.match (/\S/))
{
alert("Please Fill Content Field");
document.newStoryForm.content.focus() ;
return false;
}

 return true;
}

function checkUser(){
	 var xmlhttp;
    if (window.XMLHttpRequest)
      {// code for IE7+, Firefox, Chrome, Opera, Safari
      xmlhttp=new XMLHttpRequest();
      }
    else
      {// code for IE6, IE5
      xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
      }
    xmlhttp.onreadystatechange=function()
      {
      if (xmlhttp.readyState==4 && xmlhttp.status==200)
        {
   	   var resp=JSON.parse(xmlhttp.responseText);
   	   if(resp.login)
   		   {
   		    openForm();
   		   }
   	   else{
   		   alert("You Should Login to Write Stories");
   	   }
  
           }
         
        }
        var listAction = #{jsAction @LoginAndRegister.checkUserLogin() /}
    xmlhttp.open("GET",listAction(),true);
    xmlhttp.send();
}
</script>
<style>
.newpost{
margin: 5px;
display: block;
float: left;
}
.newpost span{
     width:150px;
     font-size: 15px;
	height:25px;
	float: left;
	background:#1f1f1f;
	color: #00A2E8;
    font-weight: bold;
	 font-family:cursive;
	-webkit-border-radius:25px;
    -moz-border-radius: 25px;
    margin: 5px;
    border-left:1px solid #00A2E8; 
	border-right:1px solid #00A2E8;
	border-top:4px solid #00A2E8;
	border-bottom: 4px solid #00A2E8;
	padding-left: 10px;
}
.newpost a{
color:#00A2E8 ;
}
.formwrapper{
 color: #00A2E8;
    font-size: 15px;
    visibility: hidden;
    display: none;
    position:absolute;
    z-index: 5;
    width: 1400px;
    height:1400px;
    font-weight: bolder;
}
.formwrapper form{
     float: left;
	 overflow:hidden;
    background:#1f1f1f;
    background: -webkit-gradient(linear, left top, left 60%, from(#1f1f1f), to(#1f1f1f));
    -webkit-border-radius:5px;
    -moz-border-radius: 5px;
    display: inline-block;
    padding: 20px;
    border: 2px solid #00A2E8;
}


.nsubmit{
    width:150px;
	height:30px;
	float: left;
	background:#000000;
	color: #00A2E8;
    font-weight: normal;
	 font-family:cursive;
	border-left:5px thin #00A2E8; 
	border-right:5px thin #00A2E8;
	-webkit-border-radius:25px;
    -moz-border-radius: 25px;
    margin: 10px;
    border-left:1px solid #00A2E8; 
	border-right:1px solid #00A2E8;
	border-top:4px solid #00A2E8;
	border-bottom: 4px solid #00A2E8;
}
.ntitle{
	float: left;
	width:500px;
	font-size: 15px;
	border-left:1px solid #00A2E8; 
	border-right:1px solid #00A2E8;
	border-top:1px solid #00A2E8;
	border-bottom: 1px solid #00A2E8;
	margin: 2px;
	
}

</style>
<div class="newpost">
<a href="javaScript:checkUser()"><span>Write Sad Story</span></a>
</div>

<div id="outerdiv" class="formwrapper">
 <form name="newStoryForm" action="@{SadStory.writeNew()}" method="POST" enctype="multipart/form-data" onsubmit="return validateNewForm()">  
        <div>Title <br/><input class="ntitle" type="text" name="title" /></div><br/> <br/>
        <div> Content <br/><textarea  name="content"> </textarea> </div><br/> 
        <div>Upload Image (Optional Field) <input class ="uploadbutton" type="file" name="imageforpost" ></div><br/> 
        <div> <input class="nsubmit" type="submit" value="Post Sad Story" /></div>
         <div><input class="nsubmit" type="button" value="Cancel" onclick="javaScript:hideform()"/></div>
         </form>
</div>